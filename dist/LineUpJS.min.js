/*! LineUpJS - v0.1.0 - 2015-08-27
* https://github.com/Caleydo/lineup.js
* Copyright (c) 2015 ; Licensed BSD */

//based on https://github.com/ForbesLindesay/umd but with d3 dependency
;(function (f) {
  // CommonJS
  if (typeof exports === "object" && typeof module !== "undefined") {
    module.exports = f(require)(1);

    // RequireJS
  } else if (typeof define === "function" && define.amd) {
    var deps = ['d3'];
    define(deps, function () {
      var resolved_deps = arguments;
      return f(function(name) { return resolved_deps[deps.indexOf(name)]; })(1);
    });
    // <script>
  } else {
    var g;
    if (typeof window !== "undefined") {
      g = window;
    } else if (typeof global !== "undefined") {
      g = global;
    } else if (typeof self !== "undefined") {
      g = self;
    } else {
      // works providing we're not in "use strict";
      // needed for Java 8 Nashorn
      // seee https://github.com/facebook/react/issues/3037
      g = this;
    }
    g.LineUpJS = f(function(name) { return g[name]; })(1);
  }

})(function (require) {
  return !function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){function d(a,b){return new h.LocalDataProvider(a,b)}function e(a,b,c){return void 0===c&&(c={}),new n(a,b,c)}var f=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},g=a("./model"),h=a("./provider"),i=a("./renderer"),j=a("./ui"),k=a("./utils"),l=a("./ui_dialogs"),m=a("d3");c.model=g,c.provider=h,c.renderer=i,c.ui=j,c.utils=k,c.ui_dialogs=l;var n=function(a){function b(b,d,e){var f=this;void 0===e&&(e={}),a.call(this),this.data=d,this.config={numberformat:m.format(".3n"),htmlLayout:{headerHeight:20,headerOffset:1,buttonTopPadding:10,labelLeftPadding:5},renderingOptions:{stacked:!1,animation:!0,visibleRowsOnly:!0},svgLayout:{rowHeight:17,rowPadding:.2,rowBarPadding:1,visibleRowsOnly:!0,backupScrollRows:4,animationDuration:1e3},manipulative:!0,interaction:{tooltips:!0,multiselect:function(){return!1},rangeselect:function(){return!1}},pool:!1},this.body=null,this.header=null,this.pool=null,this.contentScroller=null,this.$container=b instanceof m.selection?b:m.select(b),this.$container=this.$container.append("div").classed("lu",!0),c.utils.merge(this.config,e),this.header=new j.HeaderRenderer(d,this.node,{manipulative:this.config.manipulative,headerHeight:this.config.htmlLayout.headerHeight}),this.body=new j.BodyRenderer(d,this.node,this.slice.bind(this),{rowHeight:this.config.svgLayout.rowHeight,rowPadding:this.config.svgLayout.rowPadding,rowBarPadding:this.config.svgLayout.rowBarPadding,animationDuration:this.config.svgLayout.animationDuration,animation:this.config.renderingOptions.animation,stacked:this.config.renderingOptions.stacked}),this.config.pool&&this.config.manipulative&&(this.pool=new j.PoolRenderer(d,this.node,this.config)),this.config.svgLayout.visibleRowsOnly&&(this.contentScroller=new k.ContentScroller(this.$container.node(),this.body.node,{backupRows:this.config.svgLayout.backupScrollRows,rowHeight:this.config.svgLayout.rowHeight,topShift:this.config.htmlLayout.headerHeight}),this.contentScroller.on("scroll",function(a,b){console.log(a,b,"ss"),f.header.$node.style("transform","translate("+-b+"px,"+a+"px)")}),this.contentScroller.on("redraw",this.body.update.bind(this.body)))}return f(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["hoverChanged","selectionChanged"])},Object.defineProperty(b.prototype,"node",{get:function(){return this.$container.node()},enumerable:!0,configurable:!0}),b.prototype.slice=function(a,b,c){return this.contentScroller?this.contentScroller.select(a,b,c):{from:a,to:b}},b.prototype.destroy=function(){this.$container.remove(),this.contentScroller&&this.contentScroller.destroy()},b.prototype.sortBy=function(a,b){void 0===b&&(b=!1);var c=this.data.find(a);return c&&c.sortByMe(b),null!==c},b.prototype.dump=function(){var a=this.data.dump();return a},b.prototype.changeDataStorage=function(a,b){this.data=a,b&&this.data.restore(b),this.header.changeDataStorage(a),this.body.changeDataStorage(a),this.pool&&this.pool.changeDataStorage(a),this.update()},b.prototype.restore=function(a){this.changeDataStorage(this.data,a)},b.prototype.update=function(){this.header.update(),this.body.update(),this.pool&&this.pool.update()},b.prototype.changeRenderingOption=function(a,b){this.config.renderingOptions[a]=b,("animation"===a||"stacked"===a)&&(this.body.setOption(a,b),this.body.update())},b}(k.AEventDispatcher);c.LineUp=n,c.createLocalStorage=d,c.create=e},{"./model":3,"./provider":4,"./renderer":5,"./ui":6,"./ui_dialogs":7,"./utils":8,d3:void 0}],2:[function(a,b,c){function d(a,b,c,d,e,f){return a.append("line").attr({x1:b,y1:c,x2:d,y2:e,"class":f})}function e(a,b,c,d,e,f){return a.append("text").attr({x:b,y:c,dy:e,"class":f}).text(d)}function f(a,b,c,d,e){return c-=b,a.append("circle").attr({"class":"handle",r:e,cx:b,cy:d,transform:"translate("+c+",0)"})}function g(a,b,c,g){g=i.merge({width:400,height:400,padding:50,radius:10,callback:function(a){return a},callbackThisArg:null,triggerCallback:"change"},g);var j=function(i){function j(a,b){return h.behavior.drag().on("dragstart",function(){h.select(this).classed("dragging",!0).attr("r",1.1*g.radius),a.style("visibility","visible")}).on("drag",b).on("dragend",function(){h.select(this).classed("dragging",!1).attr("r",g.radius),a.style("visibility",null),m(!0)}).origin(function(){var a=h.transform(h.select(this).attr("transform"));return{x:a.translate[0],y:a.translate[1]}})}function k(){a.range([u,v]),z.attr("x1",a),m()}function l(){var b,c;x>w?(b=z.filter(function(a){return s(a)<w||s(a)>x}),c=z.filter(function(a){return!(s(a)<w||s(a)>x)})):(b=z.filter(function(a){return s(a)>w||s(a)<x}),c=z.filter(function(a){return!(s(a)>w||s(a)<x)})),b.style("visibility","hidden"),a.domain([s.invert(w),s.invert(x)]),c.style("visibility",null).attr("x1",a),m()}function m(a){if(void 0===a&&(a=!1),a===("dragend"===g.triggerCallback)){var b=h.scale.linear().domain([s.invert(w),s.invert(x)]).range([t.invert(u),t.invert(v)]);g.callback.call(g.callbackThisArg,b)}}var n=i.append("svg").attr({"class":"lugui-me",width:g.width,height:g.height}),o=g.padding,p=g.width-g.padding,q=g.padding,r=g.height-g.padding,s=h.scale.linear().domain(b).range([o,p]),t=h.scale.linear().domain([0,1]).range([o,p]),u=t(a.range()[0]),v=t(a.range()[1]),w=s(a.domain()[0]),x=s(a.domain()[1]);a=h.scale.linear().clamp(!0).domain(a.domain()).range([u,v]);var y=n.append("g");d(y,o,q,p,q,"axis"),e(y,o,q-25,0,".75em"),e(y,p,q-25,1,".75em"),e(y,g.width/2,q-25,"Score",".75em","centered"),d(y,o,r,p,r,"axis"),e(y,o,r+20,b[0],".75em"),e(y,p,r+20,b[1],".75em"),e(y,g.width/2,r+20,"Raw",".75em","centered");var z=n.append("g").classed("data",!0).selectAll("line").data([]);c.then(function(b){z=z.data(b),z.enter().append("line").attr({x1:a,y1:q,x2:s,y2:r}).style("visibility",function(a){var b;return b=x>w?s(a)<w||s(a)>x:s(a)>w||s(a)<x,b?"hidden":null})});var A=d(n,u,q,w,r,"bound"),B=d(n,v,q,x,r,"bound"),C=e(n,o+5,q-15,h.round(t.invert(u),2),".25em","drag").attr("transform","translate("+(u-o)+",0)"),D=e(n,o+5,r-15,h.round(s.invert(w),2),".25em","drag").attr("transform","translate("+(w-o)+",0)"),E=e(n,p+5,q-15,h.round(t.invert(v),2),".25em","drag").attr("transform","translate("+(v-p)+",0)"),F=e(n,p+5,r-15,h.round(s.invert(x),2),".25em","drag").attr("transform","translate("+(x-p)+",0)");f(n,o,u,q,g.radius).call(j(C,function(){h.event.x>=0&&h.event.x<=p-o&&(A.attr("x1",o+h.event.x),h.select(this).attr("transform","translate("+h.event.x+", 0)"),u=h.event.x+o,C.text(h.round(t.invert(u),2)).attr("transform","translate("+h.event.x+", 0)"),k())})),f(n,p,v,q,g.radius).call(j(E,function(){h.event.x>=-1*(p-o)&&h.event.x<=0&&(B.attr("x1",p+h.event.x),h.select(this).attr("transform","translate("+h.event.x+", 0)"),v=h.event.x+p,E.text(h.round(t.invert(v),2)).attr("transform","translate("+h.event.x+", 0)"),k())})),f(n,o,w,r,g.radius).call(j(D,function(){h.event.x>=0&&h.event.x<=p-o&&(A.attr("x2",o+h.event.x),h.select(this).attr("transform","translate("+h.event.x+", 0)"),w=h.event.x+o,D.text(h.round(s.invert(w),2)).attr("transform","translate("+h.event.x+", 0)"),l())})),f(n,p,x,r,g.radius).call(j(F,function(){h.event.x>=-1*(p-o)&&h.event.x<=0&&(B.attr("x2",p+h.event.x),h.select(this).attr("transform","translate("+h.event.x+", 0)"),x=h.event.x+p,F.text(h.round(s.invert(x),2)).attr("transform","translate("+h.event.x+", 0)"),l())}))};return j}var h=a("d3"),i=a("./utils");c.open=g},{"./utils":8,d3:void 0}],3:[function(a,b,c){function d(a){return a.replace(/[\s!#$%&'\(\)\*\+,\.\/:;<=>\?@\[\\\]\^`\{\|}~]/g,"_")}function e(a,b){return a===b||isNaN(a)&&isNaN(b)?0:a-b}function f(a){return"function"==typeof a.getNumber}function g(){return{number:m,string:n,link:o,stack:r,rank:s,categorical:p,ordinal:q}}var h=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},i=a("d3"),j=a("./utils"),k=function(a){function b(b,c){a.call(this),this.desc=c,this.width_=100,this.parent=null,this.id=d(b),this.label=this.desc.label||this.id}return h(b,a),Object.defineProperty(b.prototype,"fqid",{get:function(){return this.parent?this.parent.fqid+"_"+this.id:this.id},enumerable:!0,configurable:!0}),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["widthChanged","filterChanged","labelChanged","addColumn","removeColumn","dirty","dirtyHeader","dirtyValues"])},b.prototype.getWidth=function(){return this.width_},b.prototype.flatten=function(a,b,c,d){return void 0===c&&(c=0),void 0===d&&(d=0),a.push({col:this,offset:b,width:this.getWidth()}),this.getWidth()},b.prototype.setWidth=function(a){this.width_!==a&&this.fire(["widthChanged","dirtyHeader","dirtyValues","dirty"],this.width_,this.width_=a)},b.prototype.setWidthImpl=function(a){this.width_=a},b.prototype.setLabel=function(a){a!==this.label&&this.fire(["labelChanged","dirtyHeader","dirty"],this.label,this.label=a)},Object.defineProperty(b.prototype,"color",{get:function(){return this.desc.color||b.DEFAULT_COLOR},enumerable:!0,configurable:!0}),b.prototype.sortByMe=function(a){void 0===a&&(a=!1);var b=this.findMyRanker();return b?b.sortBy(this,a):!1},b.prototype.toggleMySorting=function(){var a=this.findMyRanker();return a?a.toggleSorting(this):!1},b.prototype.removeMe=function(){return this.parent?this.parent.remove(this):!1},b.prototype.insertAfterMe=function(a){return this.parent?this.parent.insertAfter(a,this):!1},b.prototype.findMyRanker=function(){return this.parent?this.parent.findMyRanker():null},b.prototype.dump=function(a){var b={id:this.id,desc:a(this.desc),width:this.width_};return this.label!==(this.desc.label||this.id)&&(b.label=this.label),b},b.prototype.restore=function(a){this.width_=a.width||this.width_,this.label=a.label||this.label},b.prototype.getLabel=function(a){return""+this.getValue(a)},b.prototype.getValue=function(){return""},b.prototype.compare=function(){return 0},b.prototype.isFiltered=function(){return!1},b.prototype.filter=function(a){return null!==a},b.DEFAULT_COLOR="gray",b.FLAT_ALL_COLUMNS=-1,b}(j.AEventDispatcher);c.Column=k;var l=function(a){function b(b,c){a.call(this,b,c),this.accessor=c.accessor||function(){return null}}return h(b,a),b.prototype.getLabel=function(a){return""+this.getValue(a)},b.prototype.getValue=function(a){return this.accessor(a,this.id,this.desc)},b.prototype.compare=function(){return 0},b}(k);c.ValueColumn=l,c.isNumberColumn=f;var m=function(a){function b(b,c){a.call(this,b,c),this.missingValue=0/0,this.scale=i.scale.linear().domain([0/0,0/0]).range([0,1]).clamp(!0),this.mapping=i.scale.linear().domain([0/0,0/0]).range([0,1]).clamp(!0),this.filter_={min:-1/0,max:1/0},c.domain&&this.scale.domain(c.domain),c.range&&this.scale.range(c.range),this.mapping.domain(this.scale.domain()).range(this.scale.range())}return h(b,a),b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.domain=this.scale.domain(),c.range=this.scale.range(),c.mapping=this.getMapping(),c.filter=this.filter,c.missingValue=this.missingValue,c},b.prototype.restore=function(b,c){a.prototype.restore.call(this,b,c),b.domain&&this.scale.domain(b.domain),b.range&&this.scale.range(b.range),b.mapping&&this.mapping.domain(b.mapping.domain).range(b.mapping.range),b.filter&&(this.filter_=b.filter),b.missingValue&&(this.missingValue=b.missingValue)},b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["mappingChanged"])},b.prototype.getLabel=function(b){return""+a.prototype.getValue.call(this,b)},b.prototype.getRawValue=function(b){var c=a.prototype.getValue.call(this,b);return"undefined"==typeof c||null==c||isNaN(c)||""===c||"NA"===c||"string"==typeof c&&"na"===c.toLowerCase()?this.missingValue:+c},b.prototype.getValue=function(a){var b=this.getRawValue(a);return isNaN(b)?b:this.scale(b)},b.prototype.getNumber=function(a){return this.getValue(a)},b.prototype.compare=function(a,b){return e(this.getValue(a),this.getValue(b))},b.prototype.getMapping=function(){return{domain:this.mapping.domain(),range:this.mapping.range()}},b.prototype.getOriginalMapping=function(){return{domain:this.mapping.domain(),range:this.mapping.range()}},b.prototype.setMapping=function(a,b){var c=this.getMapping();this.mapping.domain(a).range(b),this.fire(["mappingChanged","dirtyValues","dirty"],c,this.getMapping())},b.prototype.isFiltered=function(){return isFinite(this.filter_.min)||isFinite(this.filter_.max)},Object.defineProperty(b.prototype,"filterMin",{get:function(){return this.filter_.min},set:function(a){var b={min:this.filter_.min,max:this.filter_.max};this.filter_.min=isNaN(a)?-1/0:a,this.fire(["filterChanged","dirtyValues","dirty"],b,this.filter_)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"filterMax",{get:function(){return this.filter_.max},set:function(a){var b={min:this.filter_.min,max:this.filter_.max};this.filter_.max=isNaN(a)?1/0:a,this.fire(["filterChanged","dirtyValues","dirty"],b,this.filter_)},enumerable:!0,configurable:!0}),b.prototype.getFilter=function(){return this.filter_},b.prototype.setFilter=function(a,b){void 0===a&&(a=-1/0),void 0===b&&(b=+1/0);var c={min:this.filter_.min,max:this.filter_.max};this.filter_.min=isNaN(a)?-1/0:a,this.filter_.max=isNaN(b)?1/0:b,this.fire(["filterChanged","dirtyValues","dirty"],c,this.filter_)},b.prototype.filter=function(a){if(!this.isFiltered())return!0;var b=this.getRawValue(a);return isNaN(b)?!0:!(isFinite(this.filter_.min)&&b<this.filter_.min||isFinite(this.filter_.max)&&b<this.filter_.max)},b}(l);c.NumberColumn=m;var n=function(a){function b(b,c){a.call(this,b,c),this.filter_=null}return h(b,a),b.prototype.getValue=function(b){var c=a.prototype.getValue.call(this,b);return"undefined"==typeof c||null==c?"":c},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.filter=this.filter_,c},b.prototype.restore=function(b,c){a.prototype.restore.call(this,b,c),this.filter_=b.filter||null},b.prototype.isFiltered=function(){return null!=this.filter_},b.prototype.filter=function(a){if(!this.isFiltered())return!0;var b=this.getLabel(a),c=this.filter_;return"string"==typeof c&&c.length>0?b&&b.toLowerCase().indexOf(c.toLowerCase())>=0:!0},b.prototype.getFilter=function(){return this.filter_},b.prototype.setFilter=function(a){""===a&&(a=null),this.fire(["filterChanged","dirtyValues","dirty"],this.filter_,this.filter_=a)},b.prototype.compare=function(a,b){return i.ascending(this.getValue(a),this.getValue(b))},b}(l);c.StringColumn=n;var o=function(a){function b(b,c){a.call(this,b,c),this.link=null,this.link=c.link}return h(b,a),b.prototype.getLabel=function(b){var c=a.prototype.getValue.call(this,b);return c.alt?c.alt:""+c},b.prototype.getValue=function(b){var c=a.prototype.getValue.call(this,b);return c.href?c.href:this.link?this.link.replace(/\$1/g,c):c},b}(n);c.LinkColumn=o;var p=function(a){function b(b,c){a.call(this,b,c),this.colors=i.scale.category10(),this.filter_=null,this.init(c)}return h(b,a),b.prototype.init=function(a){if(a.categories){var b=[],c=this.colors.range();a.categories.forEach(function(a,d){"string"==typeof a?b.push(a):(b.push(a.name),c[d]=a.color)}),this.colors.domain(b).range(c)}},Object.defineProperty(b.prototype,"categories",{get:function(){return this.colors.domain()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"categoryColors",{get:function(){return this.colors.range()},enumerable:!0,configurable:!0}),b.prototype.getValue=function(a){return n.prototype.getValue.call(this,a)},b.prototype.getColor=function(a){var b=this.getLabel(a);return null===b||""===b?null:this.colors(b)},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.filter=this.filter_,c.colors={domain:this.colors.domain(),range:this.colors.range()},c},b.prototype.restore=function(b,c){a.prototype.restore.call(this,b,c),this.filter_=b.filter||null,b.colors&&this.colors.domain(b.colors.domain).range(b.colors.range)},b.prototype.isFiltered=function(){return null!=this.filter_},b.prototype.filter=function(a){if(!this.isFiltered())return!0;var b=this.getLabel(a),c=this.filter_;return Array.isArray(c)&&c.length>0?c.indexOf(b)>=0:"string"==typeof c&&c.length>0?b&&b.toLowerCase().indexOf(c.toLowerCase())>=0:c instanceof RegExp?null!=b&&b.match(c).length>0:!0},b.prototype.getFilter=function(){return this.filter_},b.prototype.setFilter=function(a){this.fire(["filterChanged","dirtyValues","dirty"],this,this.filter_,this.filter_=a)},b.prototype.compare=function(a,b){return n.prototype.compare.call(this,a,b)},b}(l);c.CategoricalColumn=p;var q=function(a){function b(b,c){if(a.call(this,b,c),this.colors=i.scale.category10(),this.scale=i.scale.ordinal().rangeRoundPoints([0,1]),this.filter_=null,p.prototype.init.call(this,c),this.scale.domain(this.colors.domain()),c.categories){var d=[];c.categories.forEach(function(a){d.push("string"!=typeof a&&"number"==typeof a.value?a.value:.5)}),this.scale.range(d)}}return h(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["mappingChanged"])},Object.defineProperty(b.prototype,"categories",{get:function(){return this.colors.domain()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"categoryColors",{get:function(){return this.colors.range()},enumerable:!0,configurable:!0}),b.prototype.getLabel=function(b){var c=a.prototype.getValue.call(this,b);return"undefined"==typeof c||null==c?"":c},b.prototype.getValue=function(a){var b=this.getLabel(a);return this.scale(b)},b.prototype.getNumber=function(a){return this.getValue(a)},b.prototype.getColor=function(a){return p.prototype.getColor.call(this,a)},b.prototype.dump=function(a){var b=p.prototype.dump.call(this,a);return b.scale={domain:this.scale.domain(),range:this.scale.range()},b},b.prototype.restore=function(a,b){p.prototype.restore.call(this,a,b),a.scale&&this.scale.domain(a.scale.domain).range(a.scale.range)},b.prototype.getScale=function(){return{domain:this.scale.domain(),range:this.scale.range()}},b.prototype.setRange=function(a){var b=this.getScale();this.scale.range(a),this.fire(["mappingChanged","dirtyValues","dirty"],b,this.getScale())},b.prototype.isFiltered=function(){return null!=this.filter_},b.prototype.filter=function(a){return p.prototype.filter.call(this,a)},b.prototype.getFilter=function(){return this.filter_},b.prototype.setFilter=function(a){this.fire(["filterChanged","dirtyValues","dirty"],this.filter_,this.filter_=a)},b.prototype.compare=function(a,b){return m.prototype.compare.call(this,a,b)},b}(l);c.CategoricalNumberColumn=q;var r=function(a){function b(b,c){a.call(this,b,c),this.missingValue=0/0,this.children_=[],this._collapsed=!1;var d=this;this.adaptChange=function(a,b){d.adaptWidthChange(this.source,a,b)}}return h(b,a),b.desc=function(a){return void 0===a&&(a="Combined"),{type:"stack",label:a}},b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["collapseChanged"])},Object.defineProperty(b.prototype,"children",{get:function(){return this.children_.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"length",{get:function(){return this.children_.length},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"weights",{get:function(){var a=this.getWidth();return this.children_.map(function(b){return b.getWidth()/a})},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"collapsed",{get:function(){return this._collapsed},set:function(a){this._collapsed!==a&&this.fire(["collapseChanged","dirtyHeader","dirty"],this._collapsed,this._collapsed=a)},enumerable:!0,configurable:!0}),b.prototype.flatten=function(a,b,c,d){if(void 0===c&&(c=0),void 0===d&&(d=0),0===c||c<=k.FLAT_ALL_COLUMNS){var e=this.getWidth();if(this.collapsed||(e+=(this.children_.length-1)*d),a.push({col:this,offset:b,width:e}),0===c)return e}var f=b;return this.children_.forEach(function(b){f+=b.flatten(a,f,c-1,d)+d}),f-b-d},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.children=this.children_.map(function(a){return a.dump(b)}),c.missingValue=this.missingValue,c},b.prototype.restore=function(b,c){var d=this;b.missingValue&&(this.missingValue=b.missingValue),b.children.map(function(a){d.push(c(a))}),a.prototype.restore.call(this,b,c)},b.prototype.insert=function(c,d,e){return void 0===e&&(e=0/0),f(c)?(c instanceof b&&(c.collapsed=!0),isNaN(e)||c.setWidth(e/(1-e)*this.getWidth()),this.children_.splice(d,0,c),c.parent=this,this.forward(c,"dirtyHeader.stack","dirtyValues.stack","dirty.stack","filterChanged.stack"),c.on("widthChanged.stack",this.adaptChange),a.prototype.setWidth.call(this,1===this.children_.length?c.getWidth():this.getWidth()+c.getWidth()),this.fire(["addColumn","dirtyHeader","dirtyValues","dirty"],c,c.getWidth()/this.getWidth()),!0):null},b.prototype.push=function(a,b){return void 0===b&&(b=0/0),this.insert(a,this.children_.length,b)},b.prototype.indexOf=function(a){var b=-1;return this.children_.some(function(c,d){return c===a?(b=d,!0):!1}),b},b.prototype.insertAfter=function(a,b,c){void 0===c&&(c=0/0);var d=this.indexOf(b);return 0>d?!1:this.insert(a,d+1,c)},b.prototype.adaptWidthChange=function(a,b,c){if(b!==c){var d=this.getWidth(),e=(c-b)/d,f=b/d,g=(1-f-e)/(1-f);this.children_.forEach(function(b){b===a||b.setWidthImpl(b.getWidth()*g)}),this.fire(["widthChanged","dirtyHeader","dirtyValues","dirty"],d,d)}},b.prototype.setWeights=function(a){var b,c=a.length-this.length;if(0>c)if(b=i.sum(a),1>=b)for(var d=0;-c>d;++d)a.push((1-b)*(1/-c));else if(100>=b)for(var d=0;-c>d;++d)a.push((100-b)*(1/-c));a=a.slice(0,this.length),b=i.sum(a)/this.getWidth(),a=a.map(function(a){return a/b}),this.children_.forEach(function(b,c){b.setWidthImpl(a[c])}),this.fire(["widthChanged","dirtyHeader","dirtyValues","dirty"],this.getWidth(),this.getWidth())},b.prototype.remove=function(b){var c=this.children_.indexOf(b);return 0>c?!1:(this.children_.splice(c,1),b.parent=null,this.unforward(b,"dirtyHeader.stack","dirtyValues.stack","dirty.stack","filterChanged.stack"),b.on("widthChanged.stack",null),a.prototype.setWidth.call(this,0===this.length?100:this.getWidth()-b.getWidth()),this.fire(["removeColumn","dirtyHeader","dirtyValues","dirty"],b),!0)},b.prototype.setWidth=function(b){var c=b/this.getWidth();this.children_.forEach(function(a){a.setWidthImpl(a.getWidth()*c)}),a.prototype.setWidth.call(this,b)},b.prototype.getValue=function(a){var b=this.getWidth(),c=this.children_.reduce(function(c,d){return c+d.getValue(a)*(d.getWidth()/b)},0);return"undefined"==typeof c||null==c||isNaN(c)?this.missingValue:c},b.prototype.getNumber=function(a){return this.getValue(a)},b.prototype.compare=function(a,b){return e(this.getValue(a),this.getValue(b))},b.prototype.isFiltered=function(){return this.children_.some(function(a){return a.isFiltered()})},b.prototype.filter=function(a){return this.children_.every(function(b){return b.filter(a)})},b}(k);c.StackColumn=r;var s=function(a){function b(b,c){var d=this;a.call(this,b,c),this.sortBy_=null,this.ascending=!1,this.columns_=[],this.comparator=function(a,b){if(null===d.sortBy_)return 0;var c=d.sortBy_.compare(a,b);return d.ascending?c:-c},this.dirtyOrder=function(){d.fire(["dirtyOrder","dirtyValues","dirty"],d.sortCriteria())},this.order=[],this.setWidthImpl(50)}return h(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["sortCriteriaChanged","dirtyOrder","orderChanged"])},b.prototype.setOrder=function(a){this.fire(["orderChanged","dirtyValues","dirty"],this.order,this.order=a)},b.prototype.getOrder=function(){return this.order},b.prototype.dump=function(b){var c=a.prototype.dump.call(this,b);return c.columns=this.columns_.map(function(a){return a.dump(b)}),c.sortCriteria={asc:this.ascending},this.sortBy_&&(c.sortCriteria.sortBy=this.sortBy_.id),c},b.prototype.restore=function(b,c){var d=this;a.prototype.restore.call(this,b,c),b.columns.map(function(a){d.push(c(a.col))}),b.sortCriteria&&(this.ascending=b.sortCriteria.asc,b.sortCriteria.sortBy&&this.sortBy(this.columns_.filter(function(a){return a.id===b.sortCriteria.sortBy})[0],b.sortCriteria.asc))},b.prototype.flatten=function(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=0),a.push({col:this,offset:b,width:this.getWidth()});var e=b+this.getWidth()+d;return(c>0||c<=k.FLAT_ALL_COLUMNS)&&this.columns_.forEach(function(b){e+=b.flatten(a,e,c-1,d)+d}),e-b},b.prototype.sortCriteria=function(){return{col:this.sortBy_,asc:this.ascending}},b.prototype.sortByMe=function(a){void 0===a&&(a=!1)},b.prototype.toggleMySorting=function(){},b.prototype.findMyRanker=function(){return this},b.prototype.insertAfterMe=function(a){return null!==this.insert(a,0)},b.prototype.toggleSorting=function(a){return this.sortBy_===a?this.sortBy(a,!this.ascending):this.sortBy(a)},b.prototype.sortBy=function(a,b){if(void 0===b&&(b=!1),null!==a&&a.findMyRanker()!==this)return!1;if(this.sortBy_===a&&this.ascending===b)return!0;this.sortBy_&&this.sortBy_.on("dirtyValues.order",null);var c=this.sortCriteria();return this.sortBy_=a,this.sortBy_&&this.sortBy_.on("dirtyValues.order",this.dirtyOrder),this.ascending=b,this.fire(["sortCriteriaChanged","dirtyOrder","dirtyHeader","dirtyValues","dirty"],c,this.sortCriteria()),!0},Object.defineProperty(b.prototype,"children",{get:function(){return this.columns_.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"length",{get:function(){return this.columns_.length},enumerable:!0,configurable:!0}),b.prototype.insert=function(a,b){return void 0===b&&(b=this.columns_.length),this.columns_.splice(b,0,a),a.parent=this,this.forward(a,"dirtyValues.ranking","dirtyHeader.ranking","dirty.ranking"),this.fire(["addColumn","dirtyHeader","dirtyValues","dirty"],a,b),null===this.sortBy_&&this.sortBy(a),a},b.prototype.insertAfter=function(a,b){if(b===this)return null!=this.insert(a,0);var c=this.columns_.indexOf(b);return 0>c?!1:null!=this.insert(a,c+1)},b.prototype.push=function(a){return this.insert(a)},b.prototype.remove=function(a){var b=this.columns_.indexOf(a);return 0>b?!1:(this.unforward(a,"dirtyValues.ranking","dirtyHeader.ranking","dirty.ranking"),a.parent=null,this.columns_.splice(b,1),this.fire(["removeColumn","dirtyHeader","dirtyValues","dirty"],a),this.sortBy_===a&&this.sortBy(this.columns_.length>0?this.columns_[0]:null),!0)},Object.defineProperty(b.prototype,"flatColumns",{get:function(){var a=[];return this.flatten(a,0,k.FLAT_ALL_COLUMNS),a.map(function(a){return a.col})},enumerable:!0,configurable:!0}),b.prototype.find=function(a){for(var b="string"==typeof a?function(b){return b.id===a}:a,c=this.flatColumns,d=0;d<c.length;++d)if(b(c[d]))return c[d];return null},b.prototype.toSortingDesc=function(a){var b=function(c){if(null===c)return null;if(c instanceof r){var d=c.weights;return c.children.map(function(a,c){return{weight:d[c],id:b(a)}})}return a(c.desc)},c=b(this.sortBy_);return null===c?null:{id:c,asc:this.ascending}},b.prototype.isFiltered=function(){return this.columns_.some(function(a){return a.isFiltered()})},b.prototype.filter=function(a){return this.columns_.every(function(b){return b.filter(a)})},b}(l);c.RankColumn=s,c.models=g},{"./utils":8,d3:void 0}],4:[function(a,b,c){function d(a,b,c){var d=h.layout.histogram().value(b);c&&d.range(function(){return c});var e=d(a);return{min:e[0].x,max:e[e.length-1].x+e[e.length-1].dx,count:a.length,hist:e}}var e=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},f=a("./model"),g=a("./utils"),h=a("d3"),i=function(a){function b(){a.call(this),this.rankings_=[],this.selection=h.set(),this.uid=0,this.columnTypes=f.models();var b=this;this.reorder=function(){var a=this.source;b.sort(a).then(function(b){return a.setOrder(b)})}}return e(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["addColumn","removeColumn","addRanking","removeRanking","dirty","dirtyHeader","dirtyValues","selectionChanged"])},b.prototype.getColumns=function(){return[]},b.prototype.pushRanking=function(a){var b=this.cloneRanking(a);return this.pushRankingImpl(b),b},b.prototype.pushRankingImpl=function(a){this.rankings_.push(a),this.forward(a,"addColumn.provider","removeColumn.provider","dirty.provider","dirtyHeader.provider","dirtyValues.provider"),a.on("dirtyOrder.provider",this.reorder),this.fire(["addRanking","dirtyHeader","dirtyValues","dirty"],a)},b.prototype.removeRanking=function(a){var b=this.rankings_.indexOf(a);return 0>b?!1:(this.unforward(a,"addColumn.provider","removeColumn.provider","dirty.provider","dirtyHeader.provider","dirtyOrder.provider","dirtyValues.provider"),this.rankings_.splice(b,1),a.on("dirtyOrder.provider",null),this.cleanUpRanking(a),this.fire(["removeRanking","dirtyHeader","dirtyValues","dirty"],a),!0)},b.prototype.getRankings=function(){return this.rankings_.slice()},b.prototype.cleanUpRanking=function(){},b.prototype.cloneRanking=function(){return null},b.prototype.push=function(a,b){var c=this.create(b);return c?(a.push(c),c):null},b.prototype.create=function(a){var b=this.columnTypes[a.type];return b?new b(this.nextId(),a):null},b.prototype.clone=function(a){var b=this,c=a.dump(function(a){return a}),d=function(a){var c=b.columnTypes[a.desc.type],e=new c(b.nextId(),a.desc);return e.restore(a,d),e};return d(c)},b.prototype.find=function(a){for(var b="string"==typeof a?function(b){return b.id===a}:a,c=0;c<this.rankings_.length;++c){var d=this.rankings_[c].find(b);if(d)return d}return null},b.prototype.insert=function(a,b,c){var d=this.create(c);return d?(a.insert(d,b),d):null},b.prototype.nextId=function(){return"col"+this.uid++},b.prototype.dump=function(){var a=this;return{uid:this.uid,selection:this.selection.values().map(Number),rankings:this.rankings_.map(function(b){return b.dump(a.toDescRef)})}},b.prototype.toDescRef=function(a){return a},b.prototype.fromDescRef=function(a){return a},b.prototype.restore=function(a){var b=this,c=function(a){var d=b.fromDescRef(a.desc),e=b.columnTypes[d.type],f=new e(a.id,d);return f.restore(a,c),f};this.uid=a.uid||0,a.selection&&a.selection.forEach(function(a){return b.selection.add(String(a))}),a.rankings&&a.rankings.forEach(function(a){var d=b.pushRanking();d.restore(a,c)}),a.layout&&Object.keys(a.layout).forEach(function(c){b.deriveRanking(a.layout[c])})},b.prototype.findDesc=function(){return null},b.prototype.deriveRanking=function(a){var b=this,c=function(a){if("rank"===a.type)return null;if("stacked"===a.type){var d=b.create(f.StackColumn.desc(a.label||"Combined"));return(a.children||[]).forEach(function(a){var b=c(a);b&&d.push(b)}),d}var e=b.findDesc(a.column);if(e){var d=b.create(e);return a.label=a.label||e.label||e.column,d.restore(a),d}return null},d=this.pushRanking();return a.forEach(function(a){var b=c(a);b&&d.push(b)}),d},b.prototype.sort=function(){return Promise.reject("not implemented")},b.prototype.view=function(){return Promise.reject("not implemented")},b.prototype.mappingSample=function(){return Promise.reject("not implemented")},b.prototype.stats=function(){return Promise.reject("not implemented")},b.prototype.rowKey=function(a){return String("number"==typeof a?a:a._index)},b.prototype.isSelected=function(a){return this.selection.has(String(a))},b.prototype.select=function(a){this.selection.add(String(a)),this.fire("selectionChanged",this.selection.values().map(Number))},b.prototype.searchSelect=function(){},b.prototype.selectAll=function(a){var b=this;
a.forEach(function(a){b.selection.add(String(a))}),this.fire("selectionChanged",this.selection.values().map(Number))},b.prototype.setSelection=function(a){this.selection=h.set(),this.selectAll(a)},b.prototype.deselect=function(a){this.selection.remove(String(a)),this.fire("selectionChanged",this.selection.values().map(Number))},b.prototype.selectedRows=function(){return this.selection.empty()?Promise.resolve([]):this.view(this.getSelection())},b.prototype.getSelection=function(){var a=[];return this.selection.forEach(function(b){return a.push(+b)}),a.sort(),a},b.prototype.clearSelection=function(){this.selection=h.set(),this.fire("selectionChanged",[])},b}(g.AEventDispatcher);c.DataProvider=i;var j=function(a){function b(b){var c=this;void 0===b&&(b=[]),a.call(this),this.columns=b,this.rankingIndex=0,this.rowGetter=function(a,b,c){return a[c.column]},b.forEach(function(a){return a.accessor=c.rowGetter})}return e(b,a),b.prototype.getColumns=function(){return this.columns.slice()},b.prototype.findDesc=function(a){return this.columns.filter(function(b){return b.column===a})[0]},b.prototype.toDescRef=function(a){return a.column?a.type+"@"+a.column:a},b.prototype.fromDescRef=function(a){return"string"==typeof a?this.columns.filter(function(b){return b.type+"@"+b.column===a})[0]:a},b.prototype.restore=function(b){a.prototype.restore.call(this,b),this.rankingIndex=1+h.max(this.getRankings(),function(a){return+a.id.substring(4)})},b.prototype.nextRankingId=function(){return"rank"+this.rankingIndex++},b}(i);c.CommonDataProvider=j;var k=function(a){function b(b,c){void 0===c&&(c=[]),a.call(this,c),this.data=b,b.forEach(function(a,b){a._rankings={},a._index=b})}return e(b,a),b.prototype.cloneRanking=function(a){var b=this,c=this.nextRankingId(),d={label:"Rank",type:"rank",accessor:function(a,b){return a._rankings[b]||0}},e=new f.RankColumn(c,d);return a&&(this.data.forEach(function(b){var d=b._rankings;d[c]=d[a.id]}),a.children.forEach(function(a){b.push(e,a.desc)})),e},b.prototype.cleanUpRanking=function(a){this.data.forEach(function(b){return delete b._rankings[a.id]})},b.prototype.sort=function(a){var b=this.data.map(function(b,c){return{row:b,i:c,prev:b._rankings[a.id]||0}});a.isFiltered()&&(b=b.filter(function(b){return a.filter(b.row)})),b.sort(function(b,c){return a.comparator(b.row,c.row)});var c=b.map(function(b,c){return b.row._rankings[a.id]=c,b.i});return Promise.resolve(c)},b.prototype.view=function(a){var b=this,c=a.map(function(a){return b.data[a]});return Promise.resolve(c)},b.prototype.mappingSample=function(a){return Promise.resolve(this.data.map(a.getRawValue.bind(a)))},b.prototype.stats=function(a,b){return Promise.resolve(d(this.data,b.getNumber.bind(b),[0,1]))},b}(j);c.LocalDataProvider=k;var l=function(a){function b(b,c){void 0===c&&(c=[]),a.call(this,c),this.server=b,this.ranks={}}return e(b,a),b.prototype.cloneRanking=function(a){var b=this,c=this.nextRankingId(),d={label:"Rank",type:"rank",accessor:function(a,c){return b.ranks[c][a._index]||0}};return a&&(this.ranks[c]=this.ranks[a.id]),new f.RankColumn(c,d)},b.prototype.cleanUpRanking=function(a){delete this.ranks[a.id]},b.prototype.sort=function(a){var b=this,c=a.toSortingDesc(function(a){return a.column});return this.server.sort(c).then(function(c){return b.ranks[a.id]=c,c})},b.prototype.view=function(a){return this.server.view(a).then(function(b){return b.forEach(function(b,c){return b._index=a[c]}),b})},b.prototype.mappingSample=function(a){return this.server.mappingSample(a.desc.column)},b}(j);c.RemoteDataProvider=l},{"./model":3,"./utils":8,d3:void 0}],5:[function(a,b,c){function d(a){return a?new i(a):l}function e(a){return a?new k(a):m}function f(){return{string:d(),link:new n,number:e(),rank:d({textClass:"rank",align:"right"}),stack:new p,categorical:new o,ordinal:e({colorOf:function(a,b,c){return c.getColor(a)}})}}var g=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},h=function(){function a(){this.textClass="text",this.align="left"}return a.prototype.render=function(a,b,c,d){var e=this,f=a.datum(b).selectAll("text."+this.textClass).data(c,d.rowKey);f.enter().append("text").attr({"class":this.textClass,"clip-path":"url(#"+d.idPrefix+"clipCol"+b.id+")"}),d.animated(f).attr({x:function(a,c){return d.cellX(c)+("right"===e.align?b.getWidth()-5:0)},y:function(a,b){return d.cellY(b)},"data-index":function(a,b){return b}}).text(function(a){return b.getLabel(a)}),f.exit().remove()},a.prototype.findRow=function(a,b){return a.selectAll("text."+this.textClass+'[data-index="'+b+'"]')},a.prototype.mouseEnter=function(a,b,c,d,e){var f=b.node(),g=this.findRow(a,e).node();g&&f.appendChild(g)},a.prototype.mouseLeave=function(a,b){var c=a.node(),d=b.node();d.hasChildNodes()&&c.appendChild(d.firstChild),b.selectAll("*").remove()},a}();c.DefaultCellRenderer=h;var i=function(a){function b(b){var c=this;a.call(this),Object.keys(b).forEach(function(a){c[a]=b[a]})}return g(b,a),b}(h),j=function(a){function b(){a.apply(this,arguments)}return g(b,a),b.prototype.render=function(a,b,c,d){var e=this,f=a.datum(b).selectAll("rect.bar").data(c,d.rowKey);f.enter().append("rect").attr("class","bar").style("fill",b.color),d.animated(f).attr({x:function(a,b){return d.cellX(b)},y:function(a,b){return d.cellY(b)+d.option("rowPadding",1)},height:function(a,b){return d.rowHeight(b)-2*d.option("rowPadding",1)},width:function(a){return b.getWidth()*b.getValue(a)},"data-index":function(a,b){return b}}).style({fill:function(a,c){return e.colorOf(a,c,b)}}),f.exit().remove()},b.prototype.colorOf=function(a,b,c){return c.color},b.prototype.findRow=function(a,b){return a.selectAll('rect.bar[data-index="'+b+'"]')},b.prototype.mouseEnter=function(a,b,c,d,e,f){var g=this.findRow(a,e);g.empty()||(b.node().appendChild(g.node()),b.append("text").datum(g.datum()).attr({"class":"number","clip-path":"url(#"+f.idPrefix+"clipCol"+c.id+")",transform:"translate("+f.cellX(e)+","+f.cellY(e)+")"}).text(function(a){return c.getLabel(a)}))},b}(h);c.BarCellRenderer=j;var k=function(a){function b(b){var c=this;a.call(this),Object.keys(b).forEach(function(a){c[a]=b[a]})}return g(b,a),b}(j),l=new h,m=new j;c.defaultRenderer=d,c.barRenderer=e;var n=function(a){function b(){a.apply(this,arguments)}return g(b,a),b.prototype.render=function(a,b,c,d){var e=a.datum(b).selectAll("a.link").data(c,d.rowKey);e.enter().append("a").attr({"class":"link",target:"_blank"}).append("text").attr({"class":"text","clip-path":"url(#"+d.idPrefix+"clipCol"+b.id+")"}),d.animated(e).attr({"xlink:href":function(a){return b.getValue(a)},"data-index":function(a,b){return b}}).select("text").attr({x:function(a,b){return d.cellX(b)},y:function(a,b){return d.cellY(b)}}).text(function(a){return b.getLabel(a)}),e.exit().remove()},b.prototype.findRow=function(a,b){return a.selectAll('a.link[data-index="'+b+'"]')},b}(h),o=function(a){function b(){a.apply(this,arguments),this.textClass="cat"}return g(b,a),b.prototype.render=function(a,b,c,d){var e=a.datum(b).selectAll("g."+this.textClass).data(c,d.rowKey),f=e.enter().append("g").attr({"class":this.textClass});f.append("text").attr({"clip-path":"url(#"+d.idPrefix+"clipCol"+b.id+")"}),f.append("rect").attr({y:d.option("rowPadding",1)});var g=d.animated(e).attr({"data-index":function(a,b){return b},transform:function(a,b){return"translate("+d.cellX(b)+","+d.cellY(b)+")"}});g.select("text").attr({x:function(a,b){return d.rowHeight(b)}}).text(function(a){return b.getLabel(a)}),g.select("rect").style({fill:function(a){return b.getColor(a)}}).attr({height:function(a,b){return Math.max(d.rowHeight(b)-2*d.option("rowPadding",1),0)},width:function(a,b){return Math.max(d.rowHeight(b)-2*d.option("rowPadding",1),0)}}),e.exit().remove()},b.prototype.findRow=function(a,b){return a.selectAll("g."+this.textClass+'[data-index="'+b+'"]')},b}(h),p=function(a){function b(){a.apply(this,arguments)}return g(b,a),b.prototype.renderImpl=function(a,b,c,d,e,f){void 0===f&&(f=!0);var g=a.datum(b),h=b.children,i=0,j=h.map(function(a){var b=i;return i+=a.getWidth(),b}),k=c.cellX;c.showStacked(b)||(c.cellX=function(){return 0});var l=g.selectAll("g.component").data(h,function(a){return a.id});l.enter().append("g").attr({"class":"component"}),l.attr({"class":function(a){return"component "+a.desc.type},"data-index":function(a,b){return b}}).each(function(a,f){if(c.showStacked(b)){var g=h.slice(0,f);c.cellX=function(a){return-g.reduce(function(b,c){return b+c.getWidth()*(1-c.getValue(e(a)))},0)}}d(d3.select(this),a,f,c)}),(f?c.animated(l):l).attr({transform:function(a,b){return"translate("+j[b]+",0)"}}),l.exit().remove(),c.cellX=k},b.prototype.render=function(a,b,c,d){this.renderImpl(a,b,d,function(a,b,d,e){e.renderer(b).render(a,b,c,e)},function(a){return c[a]})},b.prototype.mouseEnter=function(a,b,c,d,e,f){this.renderImpl(b,c,f,function(b,c,f,g){var h=a.selectAll('g.component[data-index="'+f+'"]');g.renderer(c).mouseEnter(h,b,c,d,e,g)},function(){return d},!1)},b.prototype.mouseLeave=function(a,b,c,d,e,f){this.renderImpl(b,c,f,function(b,c,f,g){var h=a.selectAll('g.component[data-index="'+f+'"]');g.renderer(c).mouseLeave(h,b,c,d,e,g)},function(){return d},!1),b.selectAll("*").remove()},b}(h);c.renderers=f},{}],6:[function(a,b,c){var d=a("d3"),e=a("./utils"),f=a("./model"),g=a("./renderer"),h=a("./ui_dialogs"),i=function(){function a(a){this.desc=a,this.used=0}return a}(),j=function(){function a(a,b,c){void 0===c&&(c={}),this.data=a,this.options={layout:"vertical",elemWidth:100,elemHeight:40,width:100,height:500,additionalDesc:[],hideUsed:!0},e.merge(this.options,c),this.entries=a.getColumns().concat(this.options.additionalDesc).map(function(a){return new i(a)}),this.$node=d.select(b).append("div").classed("lu-pool",!0),this.changeDataStorage(a)}return a.prototype.changeDataStorage=function(a){if(this.data&&this.data.on(["addColumn.pool","removeColumn.pool","addRanking.pool","removeRanking.pool"],null),this.data=a,this.options.hideUsed){var b=this;a.on(["addColumn.pool","removeColumn.pool"],function(a){var c=a.desc,d="addColumn"===this.type?1:-1;b.entries.some(function(a){return a.desc!==c?!1:(a.used+=d,!0)}),b.update()}),a.on(["addRanking.pool","removeRanking.pool"],function(a){var c=a.flatColumns.map(function(a){return a.desc}),d="addRanking"===this.type?1:-1;b.entries.some(function(a){return c.indexOf(a.desc)<0?!1:(a.used+=d,!0)}),b.update()}),a.getRankings().forEach(function(a){var c=a.flatColumns.map(function(a){return a.desc}),d=1;b.entries.some(function(a){return c.indexOf(a.desc)<0?!1:void(a.used+=d)})})}},a.prototype.update=function(){var a=this,b=this.data,c=this.entries.filter(function(a){return 0===a.used}).map(function(a){return a.desc}),e=this.$node.selectAll("div.header").data(c),g=e.enter().append("div").attr({"class":"header",draggable:!0}).on("dragstart",function(a){var c=d.event;c.dataTransfer.effectAllowed="copyMove",c.dataTransfer.setData("text/plain",a.label),c.dataTransfer.setData("application/caleydo-lineup-column",JSON.stringify(b.toDescRef(a)))}).style({"background-color":function(a){return a.color||f.Column.DEFAULT_COLOR},width:this.options.elemWidth+"px",height:this.options.elemHeight+"px"});g.append("span").classed("label",!0).text(function(a){return a.label}),e.style("transform",function(b,c){var d=a.layout(c);return"translate("+d.x+"px,"+d.y+"px)"}),e.select("span"),e.exit().remove()},a.prototype.layout=function(a){switch(this.options.layout){case"horizontal":return{x:a*this.options.elemWidth,y:0};case"grid":var b=d.round(this.options.width/this.options.elemWidth,0);return{x:a%b*this.options.elemWidth,y:d.round(a/b,0)*this.options.elemHeight};default:return{x:0,y:a*this.options.elemHeight}}},a}();c.PoolRenderer=j;var k=function(){function a(a,b,c){void 0===c&&(c={}),this.data=a,this.options={slopeWidth:150,columnPadding:5,headerHeight:20,manipulative:!0,filterDialogs:h.filterDialogs(),searchAble:function(a){return a instanceof f.StringColumn}},this.dragHandler=d.behavior.drag().on("dragstart",function(){d.event.sourceEvent.stopPropagation(),d.select(this).classed("dragging",!0)}).on("drag",function(a){var b=Math.max(d.mouse(this.parentNode)[0],2);a.setWidth(b),d.event.sourceEvent.stopPropagation()}).on("dragend",function(){d.select(this).classed("dragging",!1),d.event.sourceEvent.stopPropagation()}),e.merge(this.options,c),this.$node=d.select(b).append("div").classed("lu-header",!0),this.changeDataStorage(a)}return a.prototype.changeDataStorage=function(a){this.data&&this.data.on("dirtyHeader.headerRenderer",null),this.data=a,a.on("dirtyHeader.headerRenderer",e.delayedCall(this.update.bind(this),1))},a.prototype.update=function(){var a=this,b=this.data.getRankings(),c=[],d=0;b.forEach(function(b){d+=b.flatten(c,d,1,a.options.columnPadding)+a.options.slopeWidth}),d-=this.options.slopeWidth;var e=c.map(function(a){return a.col});e.some(function(a){return a instanceof f.StackColumn&&!a.collapsed})?this.$node.style("height",2*this.options.headerHeight+"px"):this.$node.style("height",this.options.headerHeight+"px"),this.renderColumns(e,c)},a.prototype.createToolbar=function(a){var b=this,c=this.options.filterDialogs,e=this.data,g=a.filter(function(a){return!(a instanceof f.RankColumn)}),i=a.filter(function(a){return a instanceof f.StackColumn});i.append("i").attr("class","fa fa-tasks").on("click",function(a){h.openEditWeightsDialog(a,d.select(this.parentNode.parentNode)),d.event.stopPropagation()}),g.append("i").attr("class","fa fa-pencil-square-o").on("click",function(a){h.openRenameDialog(a,d.select(this.parentNode.parentNode)),d.event.stopPropagation()}),g.append("i").attr("class","fa fa-code-fork").on("click",function(a){var b=e.pushRanking();b.push(e.clone(a)),d.event.stopPropagation()}),a.filter(function(a){return c.hasOwnProperty(a.desc.type)}).append("i").attr("class","fa fa-filter").on("click",function(a){c[a.desc.type](a,d.select(this.parentNode.parentNode),e),d.event.stopPropagation()}),a.filter(function(a){return b.options.searchAble(a)}).append("i").attr("class","fa fa-search").on("click",function(a){h.openSearchDialog(a,d.select(this.parentNode.parentNode),e),d.event.stopPropagation()}),a.append("i").attr("class","fa fa-times").on("click",function(a){a instanceof f.RankColumn?(e.removeRanking(a),0===e.getRankings().length&&e.pushRanking()):a.removeMe(),d.event.stopPropagation()})},a.prototype.renderColumns=function(a,b,c,g){var h=this;void 0===c&&(c=this.$node),void 0===g&&(g="header");var i=this.data,j=c.selectAll("div."+g).data(a,function(a){return a.id}),k=j.enter().append("div").attr({"class":g}).style({"background-color":function(a){return a.color}}).on("click",function(a){h.options.manipulative&&a.toggleMySorting()});k.append("i").attr("class","fa fa sort_indicator"),k.append("span").classed("label",!0).attr({draggable:this.options.manipulative}).on("dragstart",function(a){var b=d.event;b.dataTransfer.effectAllowed="copyMove",b.dataTransfer.setData("text/plain",a.label),b.dataTransfer.setData("application/caleydo-lineup-column-ref",a.id),b.dataTransfer.setData("application/caleydo-lineup-column",JSON.stringify(i.toDescRef(a.desc)))}),this.options.manipulative&&(k.append("div").classed("handle",!0).call(this.dragHandler).style("width",this.options.columnPadding+"px").call(e.dropAble(["application/caleydo-lineup-column-ref","application/caleydo-lineup-column"],function(a,b,c){var d=null;if("application/caleydo-lineup-column-ref"in a){var e=a["application/caleydo-lineup-column-ref"];d=i.find(e),c?d=i.clone(d):d.removeMe()}else{var f=JSON.parse(a["application/caleydo-lineup-column"]);d=i.create(i.fromDescRef(f))}return b.insertAfterMe(d)})),k.append("div").classed("toolbar",!0).call(this.createToolbar.bind(this))),j.style({width:function(a,c){return b[c].width+h.options.columnPadding+"px"},left:function(a,c){return b[c].offset+"px"}}),j.select("i.sort_indicator").attr("class",function(a){var b=a.findMyRanker();return b&&b.sortCriteria().col===a?"sort_indicator fa fa-sort-"+(b.sortCriteria().asc?"asc":"desc"):"sort_indicator fa"}),j.select("span.label").text(function(a){return a.label});var l=this;j.filter(function(a){return a instanceof f.StackColumn&&!a.collapsed}).each(function(a){var b=[];a.flatten(b,0,1,l.options.columnPadding);var c=b.map(function(a){return a.col});l.renderColumns(c,b,d.select(this),g+"_i")}).select("span.label").call(e.dropAble(["application/caleydo-lineup-column-ref","application/caleydo-lineup-column"],function(a,b,c){var d=null;if("application/caleydo-lineup-column-ref"in a){var e=a["application/caleydo-lineup-column-ref"];d=i.find(e),c?d=i.clone(d):d.removeMe()}else{var f=JSON.parse(a["application/caleydo-lineup-column"]);d=i.create(i.fromDescRef(f))}return b.push(d)})),j.exit().remove()},a}();c.HeaderRenderer=k;var l=function(){function a(a,b,c,f){void 0===f&&(f={}),this.data=a,this.slicer=c,this.options={rowHeight:20,rowPadding:1,rowBarPadding:1,idPrefix:"",slopeWidth:150,columnPadding:5,stacked:!0,animation:!1,animationDuration:1e3,renderers:g.renderers()},e.merge(this.options,f),this.$node=d.select(b).append("svg").classed("lu-body",!0),this.changeDataStorage(a)}return Object.defineProperty(a.prototype,"node",{get:function(){return this.$node.node()},enumerable:!0,configurable:!0}),a.prototype.setOption=function(a,b){this.options[a]=b},a.prototype.changeDataStorage=function(a){this.data&&this.data.on("dirtyValues.bodyRenderer",null),this.data=a,a.on("dirtyValues.bodyRenderer",e.delayedCall(this.update.bind(this),1))},a.prototype.createContext=function(a){var b=this.options;return{rowKey:this.data.rowKey,cellY:function(c){return(c+a)*b.rowHeight},cellX:function(){return 0},rowHeight:function(){return b.rowHeight*(1-b.rowPadding)},renderer:function(a){if(a instanceof f.StackColumn&&a.collapsed)return b.renderers.number;var c=b.renderers[a.desc.type];return c||g.defaultRenderer()},showStacked:function(){return b.stacked},idPrefix:b.idPrefix,animated:function(a){return b.animation?a.transition().duration(b.animationDuration):a},option:function(a,c){return a in b?b[a]:c}}},a.prototype.updateClipPathsImpl=function(a,b,c){var d=this.$node.select("defs.body");d.empty()&&(d=this.$node.append("defs").classed("body",!0));var e=d.selectAll(function(){return this.getElementsByTagName("clipPath")}).data(a,function(a){return a.id});e.enter().append("clipPath").attr("id",function(a){return b.idPrefix+"clipCol"+a.id}).append("rect").attr({y:0}),e.exit().remove(),e.select("rect").attr({x:0,width:function(a){return Math.max(a.getWidth()-5,0)},height:c})},a.prototype.updateClipPaths=function(a,b,c){var d=this,e=[],f=0;a.forEach(function(a){var b=a.flatten(e,f,2,d.options.columnPadding);f+=b+d.options.slopeWidth}),this.updateClipPathsImpl(e.map(function(a){return a.col}),b,c)},a.prototype.renderRankings=function(a,b,c,e,f){function g(a,b,c,g,h){a.classed("hover",!0);var i=b.selectAll("g.child").data(),k=a.select("g.values").selectAll("g.child").data(i);k.enter().append("g").attr({"class":"child"}),k.attr({transform:function(a,b){return"translate("+e[h].shifts[b]+",0)"}}).each(function(a,e){var g=this;j[h].then(function(h){f.renderer(a).mouseEnter(b.selectAll('g.child[data-index="'+e+'"]'),d.select(g),a,h[c],c,f)})}),k.exit().remove()}function h(a,b,c,e,g){a.classed("hover",!1),a.select("g.values").selectAll("g.child").each(function(a,e){var h=this;j[g].then(function(g){f.renderer(a).mouseLeave(b.selectAll('g.child[data-index="'+e+'"]'),d.select(h),a,g[c],c,f)})}).remove()}var i=this,j=c.map(function(a){return i.data.view(a)}),k=a.selectAll("g.ranking").data(b,function(a){return a.id}),l=k.enter().append("g").attr({"class":"ranking"});l.append("g").attr("class","rows"),l.append("g").attr("class","cols"),f.animated(k).attr({transform:function(a,b){return"translate("+e[b].shift+",0)"}});var m=k.select("g.cols").selectAll("g.child").data(function(a){return[a].concat(a.children)},function(a){return a.id});m.enter().append("g").attr({"class":"child"}),m.attr({"data-index":function(a,b){return b}}),f.animated(m).attr({transform:function(a,b,c){return"translate("+e[c].shifts[b]+",0)"}}).each(function(a,b,c){var e=this;j[c].then(function(b){f.renderer(a).render(d.select(e),a,b,f)})}),m.exit().remove(),this.mouseOverItem=function(a,b){void 0===b&&(b=!0),k.each(function(c,e){var f=d.select(this),i=f.selectAll('g.row[data-index="'+a+'"]'),j=f.select("g.cols");if(!i.empty()){var k=i.datum().i;b?g(i,j,k,c,e):h(i,j,k,c,e)}})};var n=k.select("g.rows").selectAll("g.row").data(function(a,b){return c[b].map(function(a,b){return{d:a,i:b}})}),o=n.enter().append("g").attr({"class":"row"});o.append("rect").attr({"class":"bg"}),o.append("g").attr({"class":"values"}),o.on("mouseenter",function(a){i.mouseOver(a.d,!0)}).on("mouseleave",function(a){i.mouseOver(a.d,!1)}).on("click",function(a){i.select(a.d,d.event.ctrlKey)}),n.attr({"data-index":function(a){return a.d}}),f.animated(n).select("rect").attr({y:function(a){return f.cellY(a.i)},height:function(a){return f.rowHeight(a.i)},width:function(a,b,c){return e[c].width}}),n.exit().remove(),k.exit().remove()},a.prototype.select=function(a,b){void 0===b&&(b=!1)},a.prototype.mouseOver=function(a,b){void 0===b&&(b=!0),this.mouseOverItem(a,b),this.$node.selectAll('line.slope[data-index="'+a+'"').classed("hover",b)},a.prototype.renderSlopeGraphs=function(a,b,c,d,e){var f=this,g=c.slice(1).map(function(a,b){return{left:c[b],left_i:b,right:a,right_i:b+1}}),h=a.selectAll("g.slopegraph").data(g);h.enter().append("g").attr({"class":"slopegraph"}),h.attr({transform:function(a,b){return"translate("+(d[b+1].shift-f.options.slopeWidth)+",0)"}});var i=h.selectAll("line.slope").data(function(a){var b={};return a.right.forEach(function(a,c){b[a]=c}),a.left.map(function(a,c){return{data_index:a,lpos:c,rpos:b[a]}}).filter(function(a){return null!=a.rpos})});i.enter().append("line").attr({"class":"slope",x2:this.options.slopeWidth}).on("mouseenter",function(a){f.mouseOver(a.data_index,!0)}).on("mouseleave",function(a){f.mouseOver(a.data_index,!1)}),i.attr({"data-index":function(a){return a.data_index}}),i.attr({y1:function(a){return.5*e.rowHeight(a.lpos)+e.cellY(a.lpos)},y2:function(a){return.5*e.rowHeight(a.rpos)+e.cellY(a.rpos)}}),i.exit().remove(),h.exit().remove()},a.prototype.update=function(){var a=this,b=this.data.getRankings(),c=d.max(b,function(a){return a.getOrder().length}),e=this.options.rowHeight*c,g=this.slicer(0,c,function(b){return b*a.options.rowHeight}),h=function(a){return 0===g.from&&a.length<=g.to?a:a.slice(g.from,Math.min(a.length,g.to))},i=b.map(function(a){return h(a.getOrder())}),j=this.createContext(g.from),k=0,l=b.map(function(b){var c=k;k+=a.options.slopeWidth;var d=0,e=[b].concat(b.children).map(function(b){var c=d;return d+=b.getWidth()+a.options.columnPadding,b instanceof f.StackColumn&&!b.collapsed&&(d+=a.options.columnPadding*(b.length-1)),c});return k+=d,{shift:c,shifts:e,width:d}});this.$node.attr({width:k,height:e}),this.updateClipPaths(b,j,e);var m=this.$node.select("g.body");m.empty()&&(m=this.$node.append("g").classed("body",!0)),this.renderRankings(m,b,i,l,j),this.renderSlopeGraphs(m,b,i,l,j)},a}();c.BodyRenderer=l},{"./model":3,"./renderer":5,"./ui_dialogs":7,"./utils":8,d3:void 0}],7:[function(a,b,c){function d(a,b,c){return void 0===c&&(c=!1),'<span style="font-weight: bold">'+a+'</span><form onsubmit="return false">'+b+'<button type = "submit" class="ok fa fa-check" title="ok"></button><button type = "reset" class="cancel fa fa-times" title="cancel"></button><button type = "button" class="reset fa fa-undo" title="reset"></button></form>'}function e(a,b){var c=m.offset(b.node()),e=d3.select("body").append("div").attr({"class":"lu-popup2"}).style({left:c.left+"px",top:c.top+"px"}).html(d("Rename Column",'<input type="text" size="15" value="'+a.label+'" required="required"><br>'));e.select(".ok").on("click",function(){var b=e.select("input").property("value");a.setLabel(b),e.remove()}),e.select(".cancel").on("click",function(){e.remove()})}function f(a,b,c){var e=m.offset(b.node()),f=d3.select("body").append("div").attr({"class":"lu-popup2"}).style({left:e.left+"px",top:e.top+"px"}).html(d("Search",'<input type="text" size="15" value="" required="required"><br><label><input type="checkbox">RegExp</label><br>'));f.select(".ok").on("click",function(){var b=f.select('input[type="text"]').property("value"),d=f.select('input[type="text"]').property("checked");d&&(b=new RegExp(b)),c.searchSelect(b,a),f.remove()}),f.select(".cancel").on("click",function(){f.remove()})}function g(a,b){function c(){j.select(".bar").transition().style({width:function(a){return g(a.weight)+"px"}})}var e=a.weights,f=a.children.map(function(a,b){return{col:a,weight:100*e[b]}}),g=d3.scale.linear().domain([0,100]).range([0,120]),h=m.offset(b.node()),i=d3.select("body").append("div").attr({"class":"lu-popup2"}).style({left:h.left+"px",top:h.top+"px"}).html(d("Edit Weights","<table></table>")),j=i.select("table").selectAll("tr").data(f),k=j.enter().append("tr");k.append("td").append("input").attr({type:"number",value:function(a){return a.weight},size:5}).on("input",function(a){a.weight=+this.value,c()}),k.append("td").append("div").attr("class","bar").style("background-color",function(a){return a.col.color}),k.append("td").text(function(a){return a.col.label}),c(),i.select(".cancel").on("click",function(){a.setWeights(e),i.remove()}),i.select(".ok").on("click",function(){a.setWeights(f.map(function(a){return a.weight})),i.remove()})}function h(a,b){function c(){var a=h.select("tbody").selectAll("tr").data(i);a.select(".checkmark").html(function(a){return'<i class="fa fa-'+(a.isChecked?"check-":"")+'square-o"></i>'}).on("click",function(a){a.isChecked=!a.isChecked,c()}),a.select(".datalabel").style("opacity",function(a){return a.isChecked?"1.0":".8"})}function e(c){b.select("i.fa-filter").classed("filtered",c&&c.length>0&&c.length<a.categories.length),a.setFilter(c)}var f=m.offset(b.node()),g=a.getFilter()||[],h=d3.select("body").append("div").attr({"class":"lu-popup"}).style({left:f.left+"px",top:f.top+"px"}).html(d("Edit Filter",'<div class="selectionTable"><table><thead><th></th><th>Category</th></thead><tbody></tbody></table></div>'));h.select(".selectionTable").style({width:"390px",height:"260px"});var i=a.categories.map(function(a){return{d:a,isChecked:0===g.length||g.indexOf(a)>=0}}),j=h.select("tbody").selectAll("tr").data(i);j.enter().append("tr"),j.append("td").attr("class","checkmark"),j.append("td").attr("class","datalabel").text(function(a){return a.d}),c(),h.select(".cancel").on("click",function(){e(g),h.remove()}),h.select(".reset").on("click",function(){i.forEach(function(a){return a.isChecked=!0}),c(),e(null)}),h.select(".ok").on("click",function(){var b=i.filter(function(a){return a.isChecked}).map(function(a){return a.d});b.length===a.categories.length&&(b=[]),e(b),h.remove()})}function i(a,b){function c(c){b.select("i.fa-filter").classed("filtered",c&&c.length>0),a.setFilter(c)}var e=m.offset(b.node()),f=a.getFilter()||"",g=d3.select("body").append("div").attr({"class":"lu-popup2"}).style({left:e.left+"px",top:e.top+"px"}).html(d("Filter",'<input type="text" placeholder="containing..." autofocus="true" size="18" value="'+f+'"><br>'));g.select(".cancel").on("click",function(){g.select("input").property("value",f),c(f),g.remove()}),g.select(".reset").on("click",function(){g.select("input").property("value",""),c(null)}),g.select(".ok").on("click",function(){c(g.select("input").property("value")),g.remove()})}function j(a,b,c){function e(c){j=c,b.select("i.fa-filter").classed("filtered",!f(j.range(),i.range)||!f(j.domain(),i.domain)),a.setMapping(j.domain(),j.range());var d=l.property("checked");d?a.setFilter(c.domain()[0],c.domain()[1]):a.setFilter()}function f(a,b){return a[0]===b[0]&&a[1]===b[1]}var g=m.offset(b.node()),h=a.getMapping(),i=a.getOriginalMapping(),j=d3.scale.linear().domain(h.domain).range(h.range),k=d3.select("body").append("div").attr({"class":"lu-popup"}).style({left:g.left+"px",top:g.top+"px",width:"420px",height:"470px"}).html(d("Change Mapping",'<div class="mappingArea"></div><label><input type="checkbox" id="filterIt" value="filterIt">Filter Outliers</label><br>')),l=k.select("input").on("change",function(){e(j)});l.property("checked",a.isFiltered());var o={callback:e,triggerCallback:"dragend"},p=c.mappingSample(a),q=n.open(d3.scale.linear().domain(h.domain).range(h.range),i.domain,p,o);k.select(".mappingArea").call(q),k.select(".ok").on("click",function(){e(j),k.remove()}),k.select(".cancel").on("click",function(){a.setMapping(h.domain,h.range),b.classed("filtered",!f(h.range,i.range)||!f(h.domain,i.domain)),k.remove()}),k.select(".reset").on("click",function(){h=i,j=d3.scale.linear().domain(h.domain).range(h.range),e(j),q=n.open(d3.scale.linear().domain(h.domain).range(h.range),i.domain,p,o),k.selectAll(".mappingArea *").remove(),k.select(".mappingArea").call(q)})}function k(a,b){function c(){k.select(".bar").transition().style({width:function(a){return h(a.range)+"px"}})}var e=a.getScale().range,f=a.categoryColors,g=a.categories.map(function(a,b){return{cat:a,range:100*e[b],color:f[b]}}),h=d3.scale.linear().domain([0,100]).range([0,120]),i=m.offset(b.node()),j=d3.select("body").append("div").attr({"class":"lu-popup2"}).style({left:i.left+"px",top:i.top+"px"}).html(d("Edit Categorical Mapping","<table></table>")),k=j.select("table").selectAll("tr").data(g),l=k.enter().append("tr");l.append("td").append("input").attr({type:"number",value:function(a){return a.range},min:0,max:100,size:5}).on("input",function(a){a.range=+this.value,c()}),l.append("td").append("div").attr("class","bar").style("background-color",function(a){return a.color}),l.append("td").text(function(a){return a.cat}),c(),j.select(".cancel").on("click",function(){a.setRange(e),j.remove()}),j.select(".ok").on("click",function(){a.setRange(g.map(function(a){return a.range/100})),j.remove()})}function l(){return{string:i,categorical:h,number:j,ordinal:k}}var m=a("./utils"),n=a("./mappingeditor");c.openRenameDialog=e,c.openSearchDialog=f,c.openEditWeightsDialog=g,c.filterDialogs=l},{"./mappingeditor":2,"./utils":8}],8:[function(a,b,c){function d(a,b,c){void 0===b&&(b=100),void 0===c&&(c=this);var d=-1;return function(){for(var e=[],f=0;f<arguments.length;f++)e[f-0]=arguments[f];d>=0&&(clearTimeout(d),d=-1),e.unshift(c),d=setTimeout(a.bind.apply(a,e),b)}}function e(a,b){return function(){for(var c=[],d=0;d<arguments.length;d++)c[d-0]=arguments[d];c.unshift(b||this.type),a.fire.apply(a,c)}}function f(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];for(var c=null,d=0;d<a.length;d++){var e=a[d],g=Object.keys(e);if(null!==c)for(var h=0;h<g.length;h++){var i=g[h],j=e[i];Object.prototype.toString.call(j)===o?(void 0===c[i]&&(c[i]={}),c[i]=f(c[i],j)):Object.prototype.toString.call(j)===p?(void 0===c[i]&&(c[i]=[]),c[i]=j.concat(c[i])):c[i]=j}else c=e}return c}function g(a){var b=a.getBoundingClientRect();return{left:b.left+window.pageXOffset,top:b.top+window.pageYOffset,width:b.width,height:b.height}}function h(a,b){var c=a.dataTransfer.types;return"function"==typeof c.indexOf?b.some(function(a){return c.indexOf(a)>=0}):"function"==typeof c.includes?b.some(function(a){return c.includes(a)}):"function"==typeof c.contains?b.some(function(a){return c.contains(a)}):!1}function i(a){var b=a.dataTransfer;return a.ctrlKey&&b.effectAllowed.match(/copy/gi)||!b.effectAllowed.match(/move/gi)}function j(a){var b=a.dataTransfer;b.dropEffect=i(a)?"copy":"move"}function k(a,b){return function(c){c.on("dragenter",function(){var b=m.event;return h(b,a)?!1:void m.select(this).classed("drag_over",!0)}).on("dragover",function(){var b=m.event;return h(b,a)?(b.preventDefault(),j(b),!1):void 0}).on("dragleave",function(){m.select(this).classed("drag_over",!1)}).on("drop",function(c){var d=m.event;if(d.preventDefault(),h(d,a)){var e={};return a.forEach(function(a){var b=d.dataTransfer.getData(a);""!==b&&(e[a]=b)}),b(e,c,null!=d.dataTransfer.dropEffect.match(/.*copy.*/i))
}})}}var l=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c},m=a("d3");c.delayedCall=d,c.forwardEvent=e;var n=function(){function a(){this.forwarder=e(this),this.listeners=m.dispatch.apply(m,this.createEventList())}return a.prototype.on=function(a,b){var c=this;return arguments.length>1?(Array.isArray(a)?a.forEach(function(a){return c.listeners.on(a,b)}):this.listeners.on(a,b),this):this.listeners.on(a)},a.prototype.createEventList=function(){return[]},a.prototype.fire=function(a){for(var b=this,c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];var e=function(a){var d={source:b,type:a,args:c};b.listeners[a].apply(d,c)};Array.isArray(a)?a.forEach(e.bind(this)):e(a)},a.prototype.forward=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];a.on(b,this.forwarder)},a.prototype.unforward=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];a.on(b,null)},a}();c.AEventDispatcher=n;var o="[object Object]",p="[object Array]";c.merge=f,c.offset=g;var q=function(a){function b(b,c,d){var e=this;void 0===d&&(d={}),a.call(this),this.container=b,this.content=c,this.options={topShift:0,backupRows:5,rowHeight:10},this.prevScrollTop=0,this.shift=0,f(this.options,d),m.select(b).on("scroll.scroller",function(){return e.onScroll()}),this.prevScrollTop=b.scrollTop,this.shift=g(c).top-g(b).top+this.options.topShift}return l(b,a),b.prototype.createEventList=function(){return a.prototype.createEventList.call(this).concat(["scroll","redraw"])},b.prototype.select=function(a,b,c){var d,e=this.container.scrollTop-this.shift,f=e+this.container.clientHeight,g=0;if(e>0){for(g=Math.round(e/this.options.rowHeight);g>=a&&c(g+1)>e;)g--;g-=this.options.backupRows}for(d=Math.round(f/this.options.rowHeight);b>=d&&c(d-1)<f;)d++;return d+=this.options.backupRows,{from:Math.max(g,a),to:Math.min(d,b)}},b.prototype.onScroll=function(){var a=this.container.scrollTop,b=this.container.scrollLeft;console.log(a,b),this.fire("scroll",a,b),Math.abs(this.prevScrollTop-a)>=this.options.rowHeight*this.options.backupRows&&(this.prevScrollTop=a,this.fire("redraw"))},b.prototype.destroy=function(){m.select(this.container).on("scroll.scroller",null)},b}(n);c.ContentScroller=q,c.hasDnDType=h,c.copyDnD=i,c.updateDropEffect=j,c.dropAble=k},{d3:void 0}]},{},[1]);